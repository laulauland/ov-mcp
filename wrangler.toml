name = "ov-mcp-server"
main = "packages/cloudflare-worker/dist/index.js"
compatibility_date = "2024-12-01"
node_compat = false

# Workers AI binding for Cloudflare Agents
[ai]
binding = "AI"

# KV Namespaces for caching GTFS data
[[kv_namespaces]]
binding = "GTFS_CACHE"
id = "${GTFS_CACHE_KV_ID}"
preview_id = "${GTFS_CACHE_PREVIEW_KV_ID}"

# R2 bucket for storing large GTFS datasets (optional)
# [[r2_buckets]]
# binding = "GTFS_STORAGE"
# bucket_name = "ov-mcp-gtfs"
# preview_bucket_name = "ov-mcp-gtfs-preview"

# Environment variables
[vars]
ENVIRONMENT = "development"
GTFS_FEED_URL = "http://gtfs.ovapi.nl/gtfs-nl.zip"
REALTIME_FEED_URL = "http://gtfs.ovapi.nl/gtfsrt"

# Production environment
[env.production]
name = "ov-mcp-server"
vars = { ENVIRONMENT = "production" }

[env.production.kv_namespaces]
GTFS_CACHE = { id = "${GTFS_CACHE_KV_ID}" }

# Staging environment
[env.staging]
name = "ov-mcp-server-staging"
vars = { ENVIRONMENT = "staging" }

[env.staging.kv_namespaces]
GTFS_CACHE = { id = "${GTFS_CACHE_PREVIEW_KV_ID}" }

# Build configuration
[build]
command = "npm run build"

# Observability
[observability]
enabled = true

# No compatibility flags needed - pure browser APIs
